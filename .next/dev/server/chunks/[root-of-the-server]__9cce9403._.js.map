{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Skrimer/Desktop/WEB/testops-site/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\r\n\r\nconst globalForPrisma = global as unknown as { prisma: PrismaClient };\r\n\r\nexport const prisma = globalForPrisma.prisma || new PrismaClient();\r\n\r\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\r\n\r\nexport default prisma;\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM;AAEC,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,6IAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG;uCAErD"}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Skrimer/Desktop/WEB/testops-site/app/api/login/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { prisma } from '@/lib/prisma';\r\nimport bcrypt from 'bcryptjs';\r\n\r\nexport async function POST(req: Request) {\r\n  try {\r\n    const { email, password } = await req.json();\r\n\r\n    if (!email || !password) {\r\n      return NextResponse.json({ message: 'Введите email и пароль' }, { status: 400 });\r\n    }\r\n\r\n    // Ищем пользователя (или по email, или можно по username докрутить)\r\n    // Здесь упрощенно считаем, что логин = email. \r\n    // Если хочешь вход по username ИЛИ email, логика чуть сложнее (OR).\r\n    const user = await prisma.user.findUnique({\r\n      where: { email }, // Prisma требует уникальное поле\r\n    });\r\n\r\n    if (!user) {\r\n      return NextResponse.json({ message: 'Неверный email или пароль' }, { status: 401 });\r\n    }\r\n\r\n    // Сверяем пароль\r\n    const isValid = await bcrypt.compare(password, user.password);\r\n\r\n    if (!isValid) {\r\n      return NextResponse.json({ message: 'Неверный email или пароль' }, { status: 401 });\r\n    }\r\n\r\n    // ВАЖНО: В реальном продакшене здесь нужно выдавать JWT токен или куку session.\r\n    // Пока для MVP вернем просто успешный ответ и данные юзера,\r\n    // а фронт сохранит это в localStorage (простой вариант).\r\n    \r\n    return NextResponse.json({\r\n      message: 'Успешный вход',\r\n      user: {\r\n        id: user.id,\r\n        email: user.email,\r\n        username: user.username,\r\n      }\r\n    });\r\n\r\n  } catch (error) {\r\n    console.error('Login error:', error);\r\n    return NextResponse.json({ message: 'Ошибка сервера' }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,MAAM,IAAI,IAAI;QAE1C,IAAI,CAAC,SAAS,CAAC,UAAU;YACvB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAAyB,GAAG;gBAAE,QAAQ;YAAI;QAChF;QAEA,oEAAoE;QACpE,+CAA+C;QAC/C,oEAAoE;QACpE,MAAM,OAAO,MAAM,yHAAM,CAAC,IAAI,CAAC,UAAU,CAAC;YACxC,OAAO;gBAAE;YAAM;QACjB;QAEA,IAAI,CAAC,MAAM;YACT,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAA4B,GAAG;gBAAE,QAAQ;YAAI;QACnF;QAEA,iBAAiB;QACjB,MAAM,UAAU,MAAM,8IAAM,CAAC,OAAO,CAAC,UAAU,KAAK,QAAQ;QAE5D,IAAI,CAAC,SAAS;YACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAA4B,GAAG;gBAAE,QAAQ;YAAI;QACnF;QAEA,gFAAgF;QAChF,4DAA4D;QAC5D,yDAAyD;QAEzD,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,MAAM;gBACJ,IAAI,KAAK,EAAE;gBACX,OAAO,KAAK,KAAK;gBACjB,UAAU,KAAK,QAAQ;YACzB;QACF;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAiB,GAAG;YAAE,QAAQ;QAAI;IACxE;AACF"}}]
}