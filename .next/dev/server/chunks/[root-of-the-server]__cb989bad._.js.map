{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Skrimer/Desktop/WEB/testops-site/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\r\n\r\nconst globalForPrisma = global as unknown as { prisma: PrismaClient };\r\n\r\nexport const prisma = globalForPrisma.prisma || new PrismaClient();\r\n\r\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\r\n\r\nexport default prisma;\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM;AAEC,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,6IAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG;uCAErD"}},
    {"offset": {"line": 68, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Skrimer/Desktop/WEB/testops-site/app/api/chats/%5Bid%5D/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { prisma } from '@/lib/prisma';\r\n\r\n// GET /api/chats/[id] - Получить историю чата\r\nexport async function GET(\r\n  req: Request,\r\n  { params }: { params: Promise<{ id: string }> } // <--- Promise (для Next.js 15)\r\n) {\r\n  try {\r\n    const { id } = await params; // <--- await (ОБЯЗАТЕЛЬНО)\r\n\r\n    const messages = await prisma.message.findMany({\r\n      where: { chatId: id },\r\n      orderBy: { createdAt: 'asc' },\r\n    });\r\n    return NextResponse.json(messages);\r\n  } catch (error) {\r\n    console.error(\"Error fetching messages:\", error);\r\n    return NextResponse.json({ message: 'Error fetching messages' }, { status: 500 });\r\n  }\r\n}\r\n\r\n// POST /api/chats/[id] - Сохранить сообщение\r\nexport async function POST(\r\n  req: Request,\r\n  { params }: { params: Promise<{ id: string }> } // <--- Promise (для Next.js 15)\r\n) {\r\n  try {\r\n    const { id } = await params; // <--- await (ОБЯЗАТЕЛЬНО)\r\n    \r\n    const body = await req.json();\r\n    console.log(`Saving message to DB for ChatID: ${id}`); // Лог для проверки\r\n\r\n    const { role, content, attachedCode, attachedFileName } = body;\r\n\r\n    const message = await prisma.message.create({\r\n      data: {\r\n        chatId: id,\r\n        role,\r\n        content,\r\n        attachedCode: attachedCode || null,\r\n        attachedFileName: attachedFileName || null,\r\n      },\r\n    });\r\n    \r\n    return NextResponse.json(message);\r\n  } catch (error) {\r\n    console.error(\"Save message error:\", error);\r\n    return NextResponse.json({ message: 'Error saving message' }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAGO,eAAe,IACpB,GAAY,EACZ,EAAE,MAAM,EAAuC,CAAC,gCAAgC;AAAjC;IAE/C,IAAI;QACF,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM,QAAQ,2BAA2B;QAExD,MAAM,WAAW,MAAM,yHAAM,CAAC,OAAO,CAAC,QAAQ,CAAC;YAC7C,OAAO;gBAAE,QAAQ;YAAG;YACpB,SAAS;gBAAE,WAAW;YAAM;QAC9B;QACA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAA0B,GAAG;YAAE,QAAQ;QAAI;IACjF;AACF;AAGO,eAAe,KACpB,GAAY,EACZ,EAAE,MAAM,EAAuC,CAAC,gCAAgC;AAAjC;IAE/C,IAAI;QACF,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM,QAAQ,2BAA2B;QAExD,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,QAAQ,GAAG,CAAC,CAAC,iCAAiC,EAAE,IAAI,GAAG,mBAAmB;QAE1E,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,YAAY,EAAE,gBAAgB,EAAE,GAAG;QAE1D,MAAM,UAAU,MAAM,yHAAM,CAAC,OAAO,CAAC,MAAM,CAAC;YAC1C,MAAM;gBACJ,QAAQ;gBACR;gBACA;gBACA,cAAc,gBAAgB;gBAC9B,kBAAkB,oBAAoB;YACxC;QACF;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAuB,GAAG;YAAE,QAAQ;QAAI;IAC9E;AACF"}}]
}